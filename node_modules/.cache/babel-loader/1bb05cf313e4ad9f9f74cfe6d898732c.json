{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _moment = require('moment');\n\nvar _moment2 = _interopRequireDefault(_moment);\n\nvar _reactDayPicker = require('react-day-picker');\n\nvar _getPosition = require('./getPosition');\n\nvar _getPosition2 = _interopRequireDefault(_getPosition);\n\nvar _DateRangeInputField = require('./DateRangeInputField');\n\nvar _DateRangeInputField2 = _interopRequireDefault(_DateRangeInputField);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar CustomDateFilter = function (_React$Component) {\n  _inherits(CustomDateFilter, _React$Component);\n\n  function CustomDateFilter(props) {\n    _classCallCheck(this, CustomDateFilter);\n\n    var _this = _possibleConstructorReturn(this, (CustomDateFilter.__proto__ || Object.getPrototypeOf(CustomDateFilter)).call(this, props));\n\n    _this.setDisplayValue = function (fromDate, toDate) {\n      var displayValue = '';\n\n      if (_moment2.default.isDate(fromDate)) {\n        if (_moment2.default.isDate(toDate)) {\n          displayValue = '\\n                ' + (0, _moment2.default)(fromDate).format('DD/MM/YYYY') + '\\n                ' + ' - ' + '\\n                ' + (0, _moment2.default)(toDate).format('DD/MM/YYYY') + '\\n                ';\n        } else displayValue = (0, _moment2.default)(fromDate).format('DD/MM/YYYY');\n      }\n\n      _this.setState({\n        displayValue: displayValue\n      });\n    };\n\n    _this.updateFilters = function (fromDate, toDate) {\n      var fromValue = (0, _moment2.default)(fromDate).format('YYYY-MM-DD');\n      var toValue = void 0;\n\n      if (_moment2.default.isDate(toDate)) {\n        _this.setDisplayValue(fromDate, toDate);\n\n        toValue = (0, _moment2.default)(toDate).hours(23).minutes(59).seconds(59).format('YYYY-MM-DD HH:mm:ss');\n      } else {\n        _this.setDisplayValue(fromDate, fromDate);\n\n        toValue = (0, _moment2.default)(fromDate).hours(23).minutes(59).seconds(59).format('YYYY-MM-DD HH:mm:ss');\n      }\n\n      _this.props.onFilter({\n        from: fromValue,\n        to: toValue\n      });\n    };\n\n    _this.clearFilters = function () {\n      _this.setState({\n        from: null,\n        to: null,\n        displayValue: ''\n      });\n\n      _this.props.onFilter();\n    };\n\n    _this.filter = function () {\n      if (_moment2.default.isDate(_this.state.from)) {\n        _this.updateFilters(_this.state.from, _this.state.to);\n      } else {\n        _this.clearFilters();\n      }\n\n      _this.windowClick();\n    };\n\n    _this.handleDayClick = function (day) {\n      var range = _reactDayPicker.DateUtils.addDayToRange(day, _this.state);\n\n      _this.setState(range);\n    };\n\n    _this.handleResetClick = function () {\n      _this.setState({\n        from: null,\n        to: null\n      });\n    };\n\n    _this.addEvents = function () {\n      window.addEventListener('click', _this.windowClick, false);\n      window.addEventListener('scroll', _this.positionPicker, false);\n      window.addEventListener('resize', _this.positionPicker, false);\n    };\n\n    _this.removeEvents = function () {\n      window.removeEventListener('click', _this.windowClick);\n      window.removeEventListener('scroll', _this.positionPicker);\n      window.removeEventListener('resize', _this.positionPicker);\n    };\n\n    _this.windowClick = function () {\n      _this.setState({\n        showPicker: false,\n        topPosition: 0,\n        leftPosition: -1000\n      });\n\n      _this.removeEvents();\n    };\n\n    _this.positionPicker = function () {\n      var parentPosition = (0, _getPosition2.default)(document.getElementById(_this.props.columnKey + '-date-filter'));\n      var elemWidth = document.getElementById(_this.props.columnKey + '-date-filter-container').offsetWidth;\n      var elemHeight = document.getElementById(_this.props.columnKey + '-date-filter-container').offsetHeight;\n      var rightOfElement = parentPosition.x + elemWidth;\n      var bottomOfElement = parentPosition.y + elemHeight;\n      var rightOfScreen = document.documentElement.offsetWidth;\n      var bottomOfScreen = Math.max(document.documentElement.offsetHeight, window.innerHeight);\n      var leftAdjustmentPadding = 2;\n      var leftAdjustment = Math.max(rightOfElement + leftAdjustmentPadding - rightOfScreen, 0);\n      var topAdjustmentPadding = 3;\n      var topAdjustment = Math.max(bottomOfElement + topAdjustmentPadding - bottomOfScreen, -22);\n\n      _this.setState({\n        topPosition: parentPosition.y - topAdjustment,\n        leftPosition: parentPosition.x - leftAdjustment\n      });\n    };\n\n    _this.togglePicker = function () {\n      _this.removeEvents();\n\n      var nextShowState = !_this.state.showPicker;\n\n      _this.setState({\n        showPicker: nextShowState,\n        topPosition: 0,\n        leftPosition: -1000\n      });\n\n      if (nextShowState) {\n        _this.positionPicker(nextShowState);\n\n        _this.addEvents();\n      }\n    };\n\n    _this.state = {\n      showPicker: false,\n      topPosition: 0,\n      leftPosition: -1000,\n      from: null,\n      to: null,\n      displayValue: ''\n    };\n    return _this;\n  }\n\n  _createClass(CustomDateFilter, [{\n    key: 'componentWillMount',\n    value: function componentWillMount() {\n      if (this.props.defaultValue && this.props.defaultValue.from) {\n        this.setState({\n          from: this.props.defaultValue.from\n        });\n        if (this.props.defaultValue.to) this.setState({\n          to: this.props.defaultValue.to\n        });\n        this.setDisplayValue(this.props.defaultValue.from, this.props.defaultValue.to);\n      }\n    }\n  }, {\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var _this2 = this; // export onFilter function to allow users to access\n\n\n      if (this.props.getFilter) {\n        this.props.getFilter(function () {\n          _this2.clearFilters();\n        });\n      }\n\n      this.filter();\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      this.removeEvents();\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var columnKey = this.props.columnKey;\n      var _state = this.state,\n          topPosition = _state.topPosition,\n          leftPosition = _state.leftPosition,\n          from = _state.from,\n          to = _state.to,\n          displayValue = _state.displayValue; // Render the Calendar\n\n      return _react2.default.createElement('div', {\n        onClick: function onClick(e) {\n          return e.stopPropagation();\n        },\n        id: columnKey + '-date-filter',\n        className: 'custom-date-filter filter'\n      }, _react2.default.createElement('span', {\n        onClick: this.togglePicker,\n        className: 'filter-value'\n      }, displayValue), _react2.default.createElement('div', {\n        className: 'dropContainer dropHide',\n        id: columnKey + '-date-filter-container',\n        style: {\n          position: 'fixed',\n          zIndex: 19,\n          top: topPosition,\n          left: leftPosition\n        }\n      }, _react2.default.createElement('div', {\n        className: 'fromToDate'\n      }, _react2.default.createElement(_DateRangeInputField2.default, {\n        handleDayClick: this.handleDayClick,\n        from: from,\n        to: to\n      })), _react2.default.createElement('div', {\n        style: {\n          clear: 'both'\n        }\n      }, _react2.default.createElement('div', {\n        id: 'cidCourseListFilterOkButton',\n        className: 'okButton filterButton',\n        onClick: this.filter\n      }, 'OK'), from && _react2.default.createElement('div', {\n        id: 'cidCourseListFilterClearFilterButton',\n        className: 'clearFilterButton',\n        onClick: this.handleResetClick\n      }, 'Clear Filter'))));\n    }\n  }]);\n\n  return CustomDateFilter;\n}(_react2.default.Component);\n\nCustomDateFilter.propTypes = {\n  onFilter: _propTypes2.default.func.isRequired,\n  columnKey: _propTypes2.default.string.isRequired,\n  defaultValue: _propTypes2.default.object,\n  getFilter: _propTypes2.default.func\n};\nCustomDateFilter.defaultProps = {\n  defaultValue: {},\n  getFilter: null\n};\nexports.default = CustomDateFilter;","map":null,"metadata":{},"sourceType":"script"}