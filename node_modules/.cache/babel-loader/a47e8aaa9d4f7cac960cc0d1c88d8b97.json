{"ast":null,"code":"import _classCallCheck from \"/Volumes/Data/React/react-api/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Volumes/Data/React/react-api/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Volumes/Data/React/react-api/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Volumes/Data/React/react-api/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Volumes/Data/React/react-api/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Volumes/Data/React/react-api/src/App.js\";\nimport React, { Component } from 'react';\nimport './App.css'; // import { BrowserRouter as Router, Route, Switch } from 'react-router-dom';\n\nimport { HashRouter as Router, Route, Switch } from 'react-router-dom'; // => /#\n\nimport Navbar from './components/Elements/Navbar';\nimport Sidebar from './components/Elements/Sidebar';\nimport Login from './pages/Login/Login';\nimport routes from './routes';\nimport { ISLOGIN, ROLE } from './constants/config';\nimport { connect } from 'react-redux';\nimport { CSSTransitionGroup } from 'react-transition-group';\nimport * as config from './constants/config';\nimport Forbidden from './pages/NotFound/403_Forbidden'; // 403\n\nimport { findIndex, split } from 'lodash';\nimport callApi from './utils/apiCaller';\nimport { actLogoutRequest } from './actions/index';\nimport { connectIO } from './socketIO/client';\nimport { ToastContainer, toast } from 'react-toastify';\n\nvar App =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(App, _Component);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this, props));\n\n    _this.onActLogout = function () {\n      _this.props.onActLogout();\n    };\n\n    _this.isAuthenticated = function (location) {\n      if (_this.state.pages !== '') {\n        // var pages = [\n        // \t{ 'page': '' },\n        // \t{ 'page': 'sms' },\n        // \t{ 'page': 'products' },\n        // \t{ 'page': 'orders' },\n        // \t{ 'page': 'customers' },\n        // \t{ 'page': 'customers/add' },\n        // \t{ 'page': 'customers/205' },\n        // ];\n        var pages = _this.state.pages;\n        var path = null;\n        var arr = split(location.pathname, '/', 3);\n\n        if (arr[2]) {\n          path = arr[1] + \"/\" + arr[2];\n        } else {\n          path = arr[1];\n        }\n\n        if (findIndex(pages, {\n          'page': path\n        }) === -1) {\n          return true;\n        }\n\n        return false;\n      }\n\n      return false;\n    };\n\n    _this.showContentMenu = function (routes, location) {\n      var result = null;\n      var role_id = _this.state.role_id;\n\n      if (role_id && role_id !== config.ADMINISTRATOR) {\n        if (_this.isAuthenticated(location)) {\n          return React.createElement(Route, {\n            exact: false,\n            path: \"/\",\n            component: Forbidden,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 160\n            },\n            __self: this\n          }); // ===> redirect to 403\n        }\n      }\n\n      if (routes.length > 0) {\n        result = routes.map(function (route, index) {\n          return React.createElement(Route, {\n            key: index,\n            path: route.path,\n            exact: route.exact,\n            component: route.main,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 167\n            },\n            __self: this\n          });\n        });\n      }\n\n      return result;\n    };\n\n    _this.state = {\n      isLogin: ISLOGIN,\n      role_id: ROLE,\n      service_id: sessionStorage.getItem('authentication') ? JSON.parse(sessionStorage.getItem('authentication')).service_id : '',\n      pages: ''\n    };\n\n    if (_this.state.role_id && _this.state.role_id === config.ASSISTANT) {\n      connectIO(function (message) {\n        if (String(_this.state.service_id) === String(message)) {\n          // this.props.getOrders(this.state.user_id);\n          toast.success(\"Bạn có bệnh nhân khám mới !\", {\n            position: \"top-right\",\n            autoClose: false,\n            hideProgressBar: true,\n            closeOnClick: true\n          });\n          console.log('123');\n          _this.audio = new Audio(\"http://183.91.11.132/alert.mp3\");\n\n          _this.audio.play();\n        }\n      });\n    }\n\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var ele = document.getElementById('ipl-progress-indicator');\n\n      if (ele) {\n        // fade out\n        ele.classList.add('available');\n        setTimeout(function () {\n          // remove from DOM\n          ele.outerHTML = '';\n        }, 300);\n      }\n\n      if (this.state.role_id) {\n        callApi('GET', config.ROLES_URL + \"/permission/\" + this.state.role_id, null).then(function (res) {\n          if (res && res.data.status) {\n            _this2.setState({\n              role_id: _this2.state.role_id,\n              pages: res.data.data\n            });\n          }\n        });\n      }\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextprops) {\n      var _this3 = this;\n\n      this.setState({\n        isLogin: nextprops.authentication.loggedIn\n      });\n\n      if (nextprops.authentication.role && typeof nextprops.authentication.role !== 'undefined') {\n        callApi('GET', config.ROLES_URL + \"/permission/\" + nextprops.authentication.role, null).then(function (res) {\n          if (res.data.status) {\n            _this3.setState({\n              role_id: nextprops.authentication.role,\n              pages: res.data.data\n            });\n          }\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      if (this.state.isLogin) {\n        return React.createElement(Router, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 91\n          },\n          __self: this\n        }, React.createElement(Route, {\n          render: function render(_ref) {\n            var location = _ref.location;\n            return React.createElement(CSSTransitionGroup, {\n              transitionName: config.PAGETRANSITION,\n              transitionAppear: true,\n              transitionAppearTimeout: config.TRANSITIONSPEED,\n              transitionEnter: false,\n              transitionLeave: false,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 93\n              },\n              __self: this\n            }, React.createElement(\"div\", {\n              className: \"App\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 94\n              },\n              __self: this\n            }, React.createElement(Navbar, {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 95\n              },\n              __self: this\n            }), React.createElement(\"div\", {\n              className: \"page-container row-fluid\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 96\n              },\n              __self: this\n            }, React.createElement(Sidebar, {\n              role_id: _this4.state.role_id,\n              onActLogout: _this4.onActLogout,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 97\n              },\n              __self: this\n            }), React.createElement(\"div\", {\n              className: \"page-content \",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 98\n              },\n              __self: this\n            }, React.createElement(\"div\", {\n              className: \"content sm-gutter\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 99\n              },\n              __self: this\n            }, React.createElement(\"div\", {\n              className: \"page-title\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 100\n              },\n              __self: this\n            })), React.createElement(Switch, {\n              location: location,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 104\n              },\n              __self: this\n            }, _this4.showContentMenu(routes, location))))));\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 92\n          },\n          __self: this\n        }));\n      } else {\n        return React.createElement(CSSTransitionGroup, {\n          transitionName: config.LOGINTRANSITION,\n          transitionAppear: true,\n          transitionAppearTimeout: config.TRANSITIONSPEED,\n          transitionEnter: false,\n          transitionLeave: false,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 118\n          },\n          __self: this\n        }, React.createElement(Login, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 119\n          },\n          __self: this\n        }));\n      }\n    }\n  }]);\n\n  return App;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    authentication: state.authentication\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch, props) {\n  return {\n    onActLogout: function onActLogout() {\n      dispatch(actLogoutRequest());\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);","map":{"version":3,"sources":["/Volumes/Data/React/react-api/src/App.js"],"names":["React","Component","HashRouter","Router","Route","Switch","Navbar","Sidebar","Login","routes","ISLOGIN","ROLE","connect","CSSTransitionGroup","config","Forbidden","findIndex","split","callApi","actLogoutRequest","connectIO","ToastContainer","toast","App","props","onActLogout","isAuthenticated","location","state","pages","path","arr","pathname","showContentMenu","result","role_id","ADMINISTRATOR","length","map","route","index","exact","main","isLogin","service_id","sessionStorage","getItem","JSON","parse","ASSISTANT","message","String","success","position","autoClose","hideProgressBar","closeOnClick","console","log","audio","Audio","play","ele","document","getElementById","classList","add","setTimeout","outerHTML","ROLES_URL","then","res","data","status","setState","nextprops","authentication","loggedIn","role","PAGETRANSITION","TRANSITIONSPEED","LOGINTRANSITION","mapStateToProps","mapDispatchToProps","dispatch"],"mappings":";;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAO,WAAP,C,CACA;;AACA,SAASC,UAAU,IAAIC,MAAvB,EAA+BC,KAA/B,EAAsCC,MAAtC,QAAoD,kBAApD,C,CAAwE;;AACxE,OAAOC,MAAP,MAAmB,8BAAnB;AACA,OAAOC,OAAP,MAAoB,+BAApB;AACA,OAAOC,KAAP,MAAkB,qBAAlB;AACA,OAAOC,MAAP,MAAmB,UAAnB;AACA,SAASC,OAAT,EAAkBC,IAAlB,QAA8B,oBAA9B;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,SAASC,kBAAT,QAAmC,wBAAnC;AACA,OAAO,KAAKC,MAAZ,MAAwB,oBAAxB;AACA,OAAOC,SAAP,MAAsB,gCAAtB,C,CAAwD;;AACxD,SAAQC,SAAR,EAAmBC,KAAnB,QAA+B,QAA/B;AACA,OAAOC,OAAP,MAAoB,mBAApB;AACA,SAASC,gBAAT,QAAiC,iBAAjC;AACA,SAASC,SAAT,QAA0B,mBAA1B;AACA,SAASC,cAAT,EAAyBC,KAAzB,QAAsC,gBAAtC;;IACMC,G;;;;;AAEL,eAAYC,KAAZ,EAAkB;AAAA;;AAAA;;AACjB,6EAAMA,KAAN;;AADiB,UA+DlBC,WA/DkB,GA+DJ,YAAM;AACnB,YAAKD,KAAL,CAAWC,WAAX;AACA,KAjEiB;;AAAA,UAyGlBC,eAzGkB,GAyGA,UAACC,QAAD,EAAc;AAC/B,UAAG,MAAKC,KAAL,CAAWC,KAAX,KAAqB,EAAxB,EAA2B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAT0B,YAUrBA,KAVqB,GAUZ,MAAKD,KAVO,CAUrBC,KAVqB;AAY1B,YAAIC,IAAI,GAAG,IAAX;AACA,YAAIC,GAAG,GAAGd,KAAK,CAACU,QAAQ,CAACK,QAAV,EAAmB,GAAnB,EAAwB,CAAxB,CAAf;;AACA,YAAGD,GAAG,CAAC,CAAD,CAAN,EAAW;AACVD,UAAAA,IAAI,GAAGC,GAAG,CAAC,CAAD,CAAH,GAAS,GAAT,GAAeA,GAAG,CAAC,CAAD,CAAzB;AACA,SAFD,MAEM;AACLD,UAAAA,IAAI,GAAGC,GAAG,CAAC,CAAD,CAAV;AACA;;AAED,YAAIf,SAAS,CAACa,KAAD,EAAQ;AAAE,kBAAQC;AAAV,SAAR,CAAT,KAAuC,CAAC,CAA5C,EAAgD;AAC/C,iBAAO,IAAP;AACA;;AACD,eAAO,KAAP;AACA;;AACD,aAAO,KAAP;AACA,KApIiB;;AAAA,UAsIlBG,eAtIkB,GAsIA,UAACxB,MAAD,EAAQkB,QAAR,EAAqB;AACtC,UAAIO,MAAM,GAAG,IAAb;AADsC,UAEjCC,OAFiC,GAEtB,MAAKP,KAFiB,CAEjCO,OAFiC;;AAGtC,UAAGA,OAAO,IAAIA,OAAO,KAAKrB,MAAM,CAACsB,aAAjC,EAAgD;AAC/C,YAAI,MAAKV,eAAL,CAAqBC,QAArB,CAAJ,EAAoC;AACnC,iBAAO,oBAAC,KAAD;AAAO,YAAA,KAAK,EAAE,KAAd;AAAqB,YAAA,IAAI,EAAC,GAA1B;AAA8B,YAAA,SAAS,EAAEZ,SAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAAP,CADmC,CAC0B;AAC7D;AACD;;AAED,UAAGN,MAAM,CAAC4B,MAAP,GAAgB,CAAnB,EAAqB;AACpBH,QAAAA,MAAM,GAAGzB,MAAM,CAAC6B,GAAP,CAAW,UAACC,KAAD,EAAQC,KAAR,EAAkB;AACrC,iBACC,oBAAC,KAAD;AACC,YAAA,GAAG,EAAEA,KADN;AAEC,YAAA,IAAI,EAAED,KAAK,CAACT,IAFb;AAGC,YAAA,KAAK,EAAES,KAAK,CAACE,KAHd;AAIC,YAAA,SAAS,EAAEF,KAAK,CAACG,IAJlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADD;AAQA,SATQ,CAAT;AAUA;;AACD,aAAOR,MAAP;AACA,KA5JiB;;AAEjB,UAAKN,KAAL,GAAa;AACZe,MAAAA,OAAO,EAAGjC,OADE;AAEZyB,MAAAA,OAAO,EAAGxB,IAFE;AAGZiC,MAAAA,UAAU,EAAEC,cAAc,CAACC,OAAf,CAAuB,gBAAvB,IAA2CC,IAAI,CAACC,KAAL,CAAWH,cAAc,CAACC,OAAf,CAAuB,gBAAvB,CAAX,EAAqDF,UAAhG,GAA6G,EAH7G;AAIZf,MAAAA,KAAK,EAAE;AAJK,KAAb;;AAOA,QAAG,MAAKD,KAAL,CAAWO,OAAX,IAAsB,MAAKP,KAAL,CAAWO,OAAX,KAAuBrB,MAAM,CAACmC,SAAvD,EAAiE;AAChE7B,MAAAA,SAAS,CAAC,UAAA8B,OAAO,EAAI;AAEpB,YAAGC,MAAM,CAAC,MAAKvB,KAAL,CAAWgB,UAAZ,CAAN,KAAkCO,MAAM,CAACD,OAAD,CAA3C,EAAsD;AACrD;AACA5B,UAAAA,KAAK,CAAC8B,OAAN,CAAc,6BAAd,EAA6C;AAAEC,YAAAA,QAAQ,EAAE,WAAZ;AAAyBC,YAAAA,SAAS,EAAE,KAApC;AAA2CC,YAAAA,eAAe,EAAE,IAA5D;AAAkEC,YAAAA,YAAY,EAAE;AAAhF,WAA7C;AACLC,UAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ;AACK,gBAAKC,KAAL,GAAa,IAAIC,KAAJ,CAAU,gCAAV,CAAb;;AACA,gBAAKD,KAAL,CAAWE,IAAX;AACA;AACD,OATQ,CAAT;AAUA;;AApBgB;AAqBjB;;;;wCAEkB;AAAA;;AAClB,UAAMC,GAAG,GAAGC,QAAQ,CAACC,cAAT,CAAwB,wBAAxB,CAAZ;;AACA,UAAGF,GAAH,EAAO;AACJ;AACFA,QAAAA,GAAG,CAACG,SAAJ,CAAcC,GAAd,CAAkB,WAAlB;AACAC,QAAAA,UAAU,CAAC,YAAM;AAChB;AACAL,UAAAA,GAAG,CAACM,SAAJ,GAAgB,EAAhB;AACA,SAHS,EAGR,GAHQ,CAAV;AAIA;;AACD,UAAG,KAAKxC,KAAL,CAAWO,OAAd,EAAsB;AACrBjB,QAAAA,OAAO,CAAC,KAAD,EAAQJ,MAAM,CAACuD,SAAP,GAAoB,cAApB,GAAqC,KAAKzC,KAAL,CAAWO,OAAxD,EAAiE,IAAjE,CAAP,CAA8EmC,IAA9E,CAAoF,UAAAC,GAAG,EAAI;AAC1F,cAAGA,GAAG,IAAIA,GAAG,CAACC,IAAJ,CAASC,MAAnB,EAA0B;AACzB,YAAA,MAAI,CAACC,QAAL,CAAc;AACbvC,cAAAA,OAAO,EAAE,MAAI,CAACP,KAAL,CAAWO,OADP;AAEbN,cAAAA,KAAK,EAAE0C,GAAG,CAACC,IAAJ,CAASA;AAFH,aAAd;AAIA;AACD,SAPD;AAQA;AAED;;;8CAEyBG,S,EAAU;AAAA;;AACnC,WAAKD,QAAL,CAAc;AACb/B,QAAAA,OAAO,EAAEgC,SAAS,CAACC,cAAV,CAAyBC;AADrB,OAAd;;AAIA,UAAGF,SAAS,CAACC,cAAV,CAAyBE,IAAzB,IAAiC,OAAOH,SAAS,CAACC,cAAV,CAAyBE,IAAhC,KAAyC,WAA7E,EAAyF;AACxF5D,QAAAA,OAAO,CAAC,KAAD,EAAQJ,MAAM,CAACuD,SAAP,GAAoB,cAApB,GAAqCM,SAAS,CAACC,cAAV,CAAyBE,IAAtE,EAA4E,IAA5E,CAAP,CAAyFR,IAAzF,CAA+F,UAAAC,GAAG,EAAI;AACrG,cAAGA,GAAG,CAACC,IAAJ,CAASC,MAAZ,EAAmB;AAClB,YAAA,MAAI,CAACC,QAAL,CAAc;AACbvC,cAAAA,OAAO,EAAEwC,SAAS,CAACC,cAAV,CAAyBE,IADrB;AAEbjD,cAAAA,KAAK,EAAE0C,GAAG,CAACC,IAAJ,CAASA;AAFH,aAAd;AAIA;AACD,SAPD;AAQA;AACD;;;6BAMQ;AAAA;;AACR,UAAI,KAAK5C,KAAL,CAAWe,OAAf,EAAyB;AACxB,eACC,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACC,oBAAC,KAAD;AAAO,UAAA,MAAM,EAAE;AAAA,gBAAGhB,QAAH,QAAGA,QAAH;AAAA,mBACd,oBAAC,kBAAD;AAAoB,cAAA,cAAc,EAAEb,MAAM,CAACiE,cAA3C;AAA2D,cAAA,gBAAgB,EAAE,IAA7E;AAAmF,cAAA,uBAAuB,EAAEjE,MAAM,CAACkE,eAAnH;AAAoI,cAAA,eAAe,EAAE,KAArJ;AAA4J,cAAA,eAAe,EAAE,KAA7K;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eACC;AAAK,cAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eACC,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADD,EAEC;AAAK,cAAA,SAAS,EAAC,0BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eACC,oBAAC,OAAD;AAAS,cAAA,OAAO,EAAE,MAAI,CAACpD,KAAL,CAAWO,OAA7B;AAAsC,cAAA,WAAW,EAAE,MAAI,CAACV,WAAxD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADD,EAEC;AAAK,cAAA,SAAS,EAAC,eAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eACC;AAAK,cAAA,SAAS,EAAC,mBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eACA;AAAK,cAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADA,CADD,EAMG,oBAAC,MAAD;AAAQ,cAAA,QAAQ,EAAEE,QAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eACE,MAAI,CAACM,eAAL,CAAqBxB,MAArB,EAA4BkB,QAA5B,CADF,CANH,CAFD,CAFD,CADD,CADc;AAAA,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADD,CADD;AA0BA,OA3BD,MA2BO;AACN,eACC,oBAAC,kBAAD;AAAoB,UAAA,cAAc,EAAEb,MAAM,CAACmE,eAA3C;AAA4D,UAAA,gBAAgB,EAAE,IAA9E;AAAoF,UAAA,uBAAuB,EAAEnE,MAAM,CAACkE,eAApH;AAAqI,UAAA,eAAe,EAAE,KAAtJ;AAA6J,UAAA,eAAe,EAAE,KAA9K;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACC,oBAAC,KAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADD,CADD;AAKA;AAED;;;;EAzGgB/E,S;;AAkKlB,IAAMiF,eAAe,GAAG,SAAlBA,eAAkB,CAAAtD,KAAK,EAAI;AAChC,SAAO;AACNgD,IAAAA,cAAc,EAAEhD,KAAK,CAACgD;AADhB,GAAP;AAGA,CAJD;;AAMA,IAAMO,kBAAkB,GAAG,SAArBA,kBAAqB,CAACC,QAAD,EAAW5D,KAAX,EAAqB;AAC5C,SAAO;AACHC,IAAAA,WAAW,EAAE,uBAAM;AACf2D,MAAAA,QAAQ,CAACjE,gBAAgB,EAAjB,CAAR;AACH;AAHE,GAAP;AAKH,CAND;;AAQA,eAAeP,OAAO,CAACsE,eAAD,EAAkBC,kBAAlB,CAAP,CAA6C5D,GAA7C,CAAf","sourcesContent":["import React, { Component } from 'react';\nimport './App.css';\n// import { BrowserRouter as Router, Route, Switch } from 'react-router-dom';\nimport { HashRouter as Router, Route, Switch } from 'react-router-dom'; // => /#\nimport Navbar from './components/Elements/Navbar';\nimport Sidebar from './components/Elements/Sidebar';\nimport Login from './pages/Login/Login';\nimport routes from './routes';\nimport { ISLOGIN, ROLE } from './constants/config';\nimport { connect } from 'react-redux';\nimport { CSSTransitionGroup } from 'react-transition-group'\nimport * as config from './constants/config';\nimport Forbidden from './pages/NotFound/403_Forbidden'; // 403\nimport {findIndex, split} from 'lodash';\nimport callApi from './utils/apiCaller';\nimport { actLogoutRequest } from './actions/index';\nimport { connectIO } from './socketIO/client';\nimport { ToastContainer, toast } from 'react-toastify';\nclass App extends Component {\n\n\tconstructor(props){\n\t\tsuper(props)\n\t\tthis.state = {\n\t\t\tisLogin : ISLOGIN,\n\t\t\trole_id : ROLE,\n\t\t\tservice_id: sessionStorage.getItem('authentication') ? JSON.parse(sessionStorage.getItem('authentication')).service_id : '',\n\t\t\tpages: ''\n\t\t}\n\n\t\tif(this.state.role_id && this.state.role_id === config.ASSISTANT){\n\t\t\tconnectIO(message => {\n\t\t\t\n\t\t\t\tif(String(this.state.service_id) === String(message)) {\n\t\t\t\t\t// this.props.getOrders(this.state.user_id);\n\t\t\t\t\ttoast.success(\"Bạn có bệnh nhân khám mới !\", { position: \"top-right\", autoClose: false, hideProgressBar: true,\tcloseOnClick: true });\nconsole.log('123');\n\t\t\t\t\tthis.audio = new Audio(\"http://183.91.11.132/alert.mp3\");\n\t\t\t\t\tthis.audio.play()\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tcomponentDidMount(){\n\t\tconst ele = document.getElementById('ipl-progress-indicator')\n\t\tif(ele){\n\t\t  \t// fade out\n\t\t\tele.classList.add('available')\n\t\t\tsetTimeout(() => {\n\t\t\t\t// remove from DOM\n\t\t\t\tele.outerHTML = ''\n\t\t\t},300)\n\t\t}\n\t\tif(this.state.role_id){\n\t\t\tcallApi('GET', config.ROLES_URL  + \"/permission/\" + this.state.role_id, null).then( res => {\n\t\t\t\tif(res && res.data.status){\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\trole_id: this.state.role_id,\n\t\t\t\t\t\tpages: res.data.data\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t\n\t}\n\n\tcomponentWillReceiveProps(nextprops){\n\t\tthis.setState({\n\t\t\tisLogin: nextprops.authentication.loggedIn\n\t\t});\t\n\n\t\tif(nextprops.authentication.role && typeof nextprops.authentication.role !== 'undefined'){\n\t\t\tcallApi('GET', config.ROLES_URL  + \"/permission/\" + nextprops.authentication.role, null).then( res => {\n\t\t\t\tif(res.data.status){\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\trole_id: nextprops.authentication.role,\n\t\t\t\t\t\tpages: res.data.data\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tonActLogout = () => {\n\t\tthis.props.onActLogout();\n\t}\n\n\trender() {\n\t\tif( this.state.isLogin ) {\n\t\t\treturn (\n\t\t\t\t<Router>\n\t\t\t\t\t<Route render={({ location }) => (\n\t\t\t\t\t\t<CSSTransitionGroup transitionName={config.PAGETRANSITION} transitionAppear={true} transitionAppearTimeout={config.TRANSITIONSPEED} transitionEnter={false} transitionLeave={false}>\n\t\t\t\t\t\t\t<div className=\"App\" >\n\t\t\t\t\t\t\t\t<Navbar/>\n\t\t\t\t\t\t\t\t<div className=\"page-container row-fluid\">\n\t\t\t\t\t\t\t\t\t<Sidebar role_id={this.state.role_id} onActLogout={this.onActLogout} />\n\t\t\t\t\t\t\t\t\t<div className=\"page-content \">\n\t\t\t\t\t\t\t\t\t\t<div className=\"content sm-gutter\">\n\t\t\t\t\t\t\t\t\t\t<div className=\"page-title\"></div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t{/* <div className=\"grid simple \">\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"grid-body no-border\"> */}\n\t\t\t\t\t\t\t\t\t\t\t\t<Switch location={location}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{this.showContentMenu(routes,location)}\n\t\t\t\t\t\t\t\t\t\t\t\t</Switch>\n\t\t\t\t\t\t\t\t\t\t\t{/* </div>\n\t\t\t\t\t\t\t\t\t\t</div> */}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</CSSTransitionGroup>\n\t\t\t\t\t)}/>\n\t\t\t\t</Router>\n\t\t\t);\n\t\t} else {\n\t\t\treturn (\n\t\t\t\t<CSSTransitionGroup transitionName={config.LOGINTRANSITION} transitionAppear={true} transitionAppearTimeout={config.TRANSITIONSPEED} transitionEnter={false} transitionLeave={false}>\n\t\t\t\t\t<Login />\n\t\t\t\t</CSSTransitionGroup>\n\t\t\t);\n\t\t}\n\t\t\n\t}\n\n\tisAuthenticated = (location) => {\n\t\tif(this.state.pages !== ''){\n\t\t\t// var pages = [\n\t\t\t// \t{ 'page': '' },\n\t\t\t// \t{ 'page': 'sms' },\n\t\t\t// \t{ 'page': 'products' },\n\t\t\t// \t{ 'page': 'orders' },\n\t\t\t// \t{ 'page': 'customers' },\n\t\t\t// \t{ 'page': 'customers/add' },\n\t\t\t// \t{ 'page': 'customers/205' },\n\t\t\t// ];\n\t\t\tvar {pages} = this.state;\n\t\t\t\n\t\t\tvar path = null;\n\t\t\tvar arr = split(location.pathname,'/', 3);\n\t\t\tif(arr[2]) {\n\t\t\t\tpath = arr[1] + \"/\" + arr[2];\n\t\t\t} else{\n\t\t\t\tpath = arr[1];\n\t\t\t}\n\t\t\t\n\t\t\tif( findIndex(pages, { 'page': path }) === -1 ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t\treturn false;\n\t}\n\n\tshowContentMenu = (routes,location) => {\n\t\tvar result = null;\n\t\tvar {role_id} = this.state;\n\t\tif(role_id && role_id !== config.ADMINISTRATOR) {\n\t\t\tif( this.isAuthenticated(location) ){\n\t\t\t\treturn <Route exact={false} path='/' component={Forbidden}/> // ===> redirect to 403\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(routes.length > 0){\n\t\t\tresult = routes.map((route, index) => {\n\t\t\t\treturn (\n\t\t\t\t\t<Route \n\t\t\t\t\t\tkey={index} \n\t\t\t\t\t\tpath={route.path} \n\t\t\t\t\t\texact={route.exact} \n\t\t\t\t\t\tcomponent={route.main} \n\t\t\t\t\t/>\n\t\t\t\t);\n\t\t\t})\n\t\t}\n\t\treturn result;\n\t}\n\t\n}\n\nconst mapStateToProps = state => {\n\treturn {\n\t\tauthentication: state.authentication,\n\t}\n}\n\nconst mapDispatchToProps = (dispatch, props) => {\n    return {\n        onActLogout: () => {\n            dispatch(actLogoutRequest());\n        }\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\n\n"]},"metadata":{},"sourceType":"module"}