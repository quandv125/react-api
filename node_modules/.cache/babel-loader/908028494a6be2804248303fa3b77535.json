{"ast":null,"code":"import _defineProperty from \"/Volumes/Data/React/react-api/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Volumes/Data/React/react-api/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Volumes/Data/React/react-api/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Volumes/Data/React/react-api/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Volumes/Data/React/react-api/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Volumes/Data/React/react-api/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Volumes/Data/React/react-api/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Volumes/Data/React/react-api/src/pages/Orders/OrderActionPage.js\";\nimport React, { Component } from 'react';\nimport { CSSTransitionGroup } from 'react-transition-group';\nimport Button from '@material-ui/core/Button'; // import { Link } from 'react-router-dom';\n\nimport * as config from '../../constants/config';\nimport callApi from '../../utils/apiCaller';\nimport OrderInfo from './../../components/Orders/OrderInfo';\nimport CustomerInfo from './../../components/Orders/CustomerInfo';\nimport AddDoctor from './../../components/Orders/AddDoctor';\nimport AddServices from './../../components/Orders/AddServices';\nimport DatePicker from 'react-datepicker'; // import moment from 'moment';\n\nimport 'react-datepicker/dist/react-datepicker.css';\nimport Swal from 'sweetalert2';\n\nvar OrderActionPage =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(OrderActionPage, _Component);\n\n  function OrderActionPage(props) {\n    var _this;\n\n    _classCallCheck(this, OrderActionPage);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(OrderActionPage).call(this, props));\n\n    _this.today = function () {\n      var today = new Date();\n      var dd = today.getDate();\n      var mm = today.getMonth() + 1; //January is 0!\n\n      var yyyy = today.getFullYear();\n\n      if (dd < 10) {\n        dd = '0' + dd;\n      }\n\n      if (mm < 10) {\n        mm = '0' + mm;\n      }\n\n      return yyyy + '-' + mm + '-' + dd;\n    };\n\n    _this.handleChange = function (date) {\n      var valueOfInput = date.format('YYYY-MM-DD H:mm:ss');\n\n      _this.setState({\n        date_remain: valueOfInput,\n        startDate: date\n      });\n    };\n\n    _this.handleDeleteService = function (id) {\n      callApi('DELETE', config.ORDER_DETAIL_URL + id, null).then(function (response) {\n        if (response && response.data.status) {\n          _this.getOrderDetail(_this.state.order.id);\n        }\n      });\n    };\n\n    _this.handleAddService = function (data_props) {\n      var product_service_id = data_props.product_service_id,\n          product_quantity = data_props.product_quantity;\n      var order = _this.state.order;\n      var data = {\n        order_id: order.id,\n        product_id: product_service_id,\n        quantity: product_quantity\n      };\n\n      if (product_service_id && product_service_id !== \"\") {\n        callApi('POST', config.ORDER_DETAIL_URL, data).then(function (res) {\n          _this.getOrderDetail(order.id);\n        });\n      } else {\n        Swal('Oops...', 'Something went wrong!', 'error');\n      }\n    };\n\n    _this.handleAddRemain = function (event) {\n      event.preventDefault();\n      var time = _this.state.date_remain;\n      var data = {\n        time: time,\n        is_send_sms: 0\n      };\n\n      if (time !== '') {\n        callApi('PUT', config.ORDER_URL + _this.state.order.id, data).then(function (res) {\n          if (res && res.data.status) {\n            _this.setState({\n              date_remain: time\n            });\n\n            Swal('Good job!', 'You clicked the button!', 'success');\n          }\n        });\n      } else {\n        Swal('Oops...', 'Something went wrong!', 'error');\n      }\n    };\n\n    _this.handleAddDoctor = function (user_id) {\n      var order = _this.state.order;\n\n      if (user_id !== null && user_id !== \"0\") {\n        var data = {\n          user_id: user_id\n        };\n        callApi('PUT', config.ORDER_URL + 'user/' + order.id, data).then(function (res) {\n          if (res.data.status) {\n            _this.setState({\n              doctor: res.data.data.user\n            });\n\n            Swal('Good job!', 'You clicked the button!', 'success');\n          }\n        });\n      } else {\n        Swal('Oops...', 'Something went wrong!', 'error');\n      }\n    };\n\n    _this.remainder = function (date_remain) {\n      var date = null;\n\n      if (typeof date_remain !== 'undefined' && date_remain.length > 1) {\n        var from = date_remain.slice(0, 10).split(\"-\");\n        date = from[2] + '/' + from[1] + '/' + from[0];\n      }\n\n      return date;\n    };\n\n    _this.state = {\n      service: '',\n      customer: '',\n      product: '',\n      product_quantity: 1,\n      customerData: '',\n      product_service_id: '',\n      categories: '',\n      order: '',\n      order_detail: '',\n      category_title: '',\n      date_remain: '',\n      // startDate: moment()\n      startDate: null,\n      doctor: ''\n    };\n    _this.onSave = _this.onSave.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.onChangeForm = _this.onChangeForm.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(OrderActionPage, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      var _this2 = this;\n\n      var match = this.props.match;\n\n      if (match) {\n        var _match$params = match.params,\n            id = _match$params.id,\n            customer_id = _match$params.customer_id;\n        callApi('GET', config.ORDER_URL + id, null).then(function (res) {\n          if (res && res.data.data) {\n            _this2.setState({\n              order: res.data.data,\n              date_remain: res.data.data.time === null ? '' : res.data.data.time,\n              category_title: res.data.category.title\n            });\n\n            var category_id = res.data.data.product_category_id;\n            callApi('GET', config.PRODUCT_URL + 'category/' + category_id, null).then(function (res) {\n              _this2.setState({\n                categories: res.data.data\n              });\n            });\n          }\n        });\n        callApi('GET', config.CUSTOMER_URL + customer_id, null).then(function (response) {\n          if (response) {\n            _this2.setState({\n              customer: response.data.data\n            });\n          }\n        });\n\n        if (id) {\n          this.getOrderDetail(id);\n          callApi('GET', config.ORDER_URL + 'user/' + id, null).then(function (res) {\n            if (res.data.status) {\n              _this2.setState({\n                doctor: res.data.data.user\n              });\n            }\n          });\n        }\n      }\n    }\n  }, {\n    key: \"getOrderDetail\",\n    value: function getOrderDetail(id) {\n      var _this3 = this;\n\n      callApi('GET', config.ORDER_DETAIL_URL + \"order/\" + id, null).then(function (res) {\n        if (res && res.data.status) {\n          _this3.setState({\n            order_detail: res.data.data,\n            time: res.data.data.time\n          });\n        }\n      });\n    }\n  }, {\n    key: \"onChangeForm\",\n    value: function onChangeForm(event) {\n      var target = event.target;\n      var name = target.name;\n      var value = target.type === 'checkbox' ? target.checked : target.value;\n      this.setState(_defineProperty({}, name, value));\n    }\n  }, {\n    key: \"onSave\",\n    value: function onSave(event) {\n      event.preventDefault();\n      var history = this.props.history;\n      var _this$state = this.state,\n          id = _this$state.id,\n          sku = _this$state.sku,\n          title = _this$state.title,\n          price = _this$state.price,\n          quantity = _this$state.quantity,\n          unit = _this$state.unit,\n          is_publish = _this$state.is_publish;\n      var data = {\n        sku: sku,\n        title: title,\n        price: price,\n        quantity: quantity,\n        unit: unit,\n        is_publish: is_publish ? true : false\n      };\n\n      if (id) {\n        //update\n        callApi('PUT', config.ORDER_URL + id, data).then(function (res) {\n          console.log(res);\n          history.push(\"/orders\");\n        });\n      } else {\n        //create\n        callApi('POST', config.ORDER_URL, data).then(function (res) {\n          //C1 // history.push(\"/orders-list\");\n          // console.log(res);\n          // history.push(\"/orders\");\n          //C2: redirect \n          history.goBack();\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state2 = this.state,\n          order = _this$state2.order,\n          customer = _this$state2.customer,\n          order_detail = _this$state2.order_detail,\n          category_title = _this$state2.category_title,\n          date_remain = _this$state2.date_remain,\n          doctor = _this$state2.doctor,\n          categories = _this$state2.categories;\n      return React.createElement(CSSTransitionGroup, {\n        transitionName: \"worksTransition\",\n        transitionAppear: true,\n        transitionAppearTimeout: 500,\n        transitionEnter: false,\n        transitionLeave: false,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212\n        },\n        __self: this\n      }, React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214\n        },\n        __self: this\n      }, React.createElement(OrderInfo, {\n        order: order,\n        category_title: category_title,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216\n        },\n        __self: this\n      }), React.createElement(CustomerInfo, {\n        customer: customer,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 218\n        },\n        __self: this\n      }), React.createElement(AddDoctor, {\n        doctor: doctor,\n        handleAddDoctor: this.handleAddDoctor,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"clearfix\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222\n        },\n        __self: this\n      }), React.createElement(AddServices, {\n        categories: categories,\n        order_detail: order_detail,\n        customer: customer,\n        handleDeleteService: this.handleDeleteService,\n        handleAddService: this.handleAddService,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"clearfix\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 233\n        },\n        __self: this\n      })));\n    } // end render\n\n  }]);\n\n  return OrderActionPage;\n}(Component);\n\nexport default OrderActionPage;","map":{"version":3,"sources":["/Volumes/Data/React/react-api/src/pages/Orders/OrderActionPage.js"],"names":["React","Component","CSSTransitionGroup","Button","config","callApi","OrderInfo","CustomerInfo","AddDoctor","AddServices","DatePicker","Swal","OrderActionPage","props","today","Date","dd","getDate","mm","getMonth","yyyy","getFullYear","handleChange","date","valueOfInput","format","setState","date_remain","startDate","handleDeleteService","id","ORDER_DETAIL_URL","then","response","data","status","getOrderDetail","state","order","handleAddService","data_props","product_service_id","product_quantity","order_id","product_id","quantity","res","handleAddRemain","event","preventDefault","time","is_send_sms","ORDER_URL","handleAddDoctor","user_id","doctor","user","remainder","length","from","slice","split","service","customer","product","customerData","categories","order_detail","category_title","onSave","bind","onChangeForm","match","params","customer_id","category","title","category_id","product_category_id","PRODUCT_URL","CUSTOMER_URL","target","name","value","type","checked","history","sku","price","unit","is_publish","console","log","push","goBack"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { CSSTransitionGroup } from 'react-transition-group';\nimport Button from '@material-ui/core/Button';\n// import { Link } from 'react-router-dom';\nimport * as config from '../../constants/config';\nimport callApi from '../../utils/apiCaller';\nimport OrderInfo from './../../components/Orders/OrderInfo';\nimport CustomerInfo from './../../components/Orders/CustomerInfo';\nimport AddDoctor from './../../components/Orders/AddDoctor';\nimport AddServices from './../../components/Orders/AddServices';\n\n\nimport DatePicker from 'react-datepicker';\n// import moment from 'moment';\nimport 'react-datepicker/dist/react-datepicker.css';\nimport Swal from 'sweetalert2'\n\n\nclass OrderActionPage extends Component {\n\n\tconstructor(props){\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tservice: '',\n\t\t\tcustomer: '',\n\t\t\tproduct: '',\n\t\t\tproduct_quantity: 1,\n\t\t\tcustomerData: '',\n\t\t\tproduct_service_id: '',\n\t\t\tcategories: '',\n\t\t\torder: '',\n\t\t\torder_detail: '',\n\t\t\tcategory_title: '',\n\t\t\tdate_remain: '',\n\t\t\t// startDate: moment()\n\t\t\tstartDate: null,\n\t\t\tdoctor: '',\n\n\t\t};\n\t\tthis.onSave = this.onSave.bind(this);\n\t\tthis.onChangeForm = this.onChangeForm.bind(this);\n\t}\n\t\n\tcomponentWillMount(){\n\t\t\n\t\tvar {match} = this.props;\n\t\tif(match) {\n\t\t\tvar {id, customer_id} = match.params;\n\t\t\n\t\t\tcallApi('GET', config.ORDER_URL + id, null).then(res => {\n\t\t\t\tif (res && res.data.data){\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\torder: res.data.data,\n\t\t\t\t\t\tdate_remain: res.data.data.time === null ? '' : res.data.data.time,\n\t\t\t\t\t\tcategory_title: res.data.category.title\n\t\t\t\t\t});\n\t\t\t\t\tvar category_id = res.data.data.product_category_id;\n\t\t\t\t\tcallApi('GET', config.PRODUCT_URL+'category/'+category_id, null).then(res => {\n\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\tcategories: res.data.data\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\t\n\t\t\tcallApi('GET', config.CUSTOMER_URL + customer_id, null).then(response => {\n\t\t\t\tif (response ){\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\tcustomer: response.data.data\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\tif(id){\n\t\t\t\tthis.getOrderDetail(id);\n\t\t\t\tcallApi('GET', config.ORDER_URL + 'user/' + id, null).then(res => {\n\t\t\t\t\tif ( res.data.status ) {\n\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\tdoctor: res.data.data.user\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\ttoday = () => {\n\t\tvar today = new Date();\n\t\tvar dd = today.getDate();\n\t\tvar mm = today.getMonth()+1; //January is 0!\n\t\tvar yyyy = today.getFullYear();\n\t\tif(dd<10){\n\t\t\tdd='0'+dd;\n\t\t} \n\t\tif(mm<10){\n\t\t\tmm='0'+mm;\n\t\t} \n\t\treturn yyyy+'-'+mm+'-'+dd;\n\t}\n\n\tgetOrderDetail(id){\n\t\tcallApi('GET', config.ORDER_DETAIL_URL+ \"order/\" + id, null).then(res => {\n\t\t\tif(res && res.data.status){\n\t\t\t\tthis.setState({\n\t\t\t\t\torder_detail: res.data.data,\n\t\t\t\t\ttime: res.data.data.time\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\thandleChange = (date) => {\n\t\tconst valueOfInput = date.format('YYYY-MM-DD H:mm:ss');\n\t\tthis.setState({\n\t\t\tdate_remain: valueOfInput,\n\t\t  \tstartDate: date\n\t\t});\n\t}\n\n\tonChangeForm (event) {\n\t\tvar target = event.target;\n\t\tvar name = target.name;\n\t\tvar value = target.type === 'checkbox'? target.checked:target.value;\n\t\tthis.setState({\n\t\t\t[name]: value\n\t\t});\n\t}\n\n\tonSave (event) {\n\t\tevent.preventDefault();\n\n\t\tvar {history} = this.props;\n\t\tvar {id, sku, title, price, quantity, unit, is_publish} = this.state;\n\t\tvar data = {sku: sku, title: title, price: price, quantity: quantity, unit: unit, is_publish: is_publish ? true : false };\n\t\tif(id) { //update\n\t\t\tcallApi('PUT', config.ORDER_URL + id, data).then( res => {\n\t\t\t\tconsole.log(res);\n\t\t\t\thistory.push(\"/orders\");\n\t\t\t});\n\t\t} else { //create\n\t\t\tcallApi('POST', config.ORDER_URL, data ).then( res => {\n\t\t\t\t//C1 // history.push(\"/orders-list\");\n\t\t\t\t// console.log(res);\n\t\t\t\t// history.push(\"/orders\");\n\t\t\t\t//C2: redirect \n\t\t\t\thistory.goBack();\n\t\t\t});\n\t\t}\n\t}\n\n\thandleDeleteService = (id) => {\n\t\tcallApi('DELETE', config.ORDER_DETAIL_URL+id, null).then(response => {\n\t\t\tif(response && response.data.status){\n\t\t\t\tthis.getOrderDetail(this.state.order.id);\n\t\t\t}\n\t\t});\n\t}\n\n\thandleAddService = (data_props) => {\n\t\tvar {product_service_id, product_quantity}  = data_props;\n\t\tvar {order}  = this.state;\n\t\tvar data = {order_id: order.id, product_id : product_service_id, quantity: product_quantity}\n\t\tif (product_service_id && product_service_id !== \"\"){\n\t\t\tcallApi('POST', config.ORDER_DETAIL_URL, data).then(res => {\n\t\t\t\tthis.getOrderDetail(order.id)\n\t\t\t});\n\t\t} else {\n\t\t\tSwal('Oops...', 'Something went wrong!', 'error')\n\t\t}\n\t}\n\n\thandleAddRemain = (event) => {\n\t\tevent.preventDefault();\n\t\tvar time = this.state.date_remain;\n\t\tvar data = {time: time, is_send_sms: 0}\n\t\tif( time !== ''){\n\t\t\tcallApi('PUT', config.ORDER_URL + this.state.order.id, data).then(res => {\n\t\t\t\tif(res && res.data.status){\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\tdate_remain: time\n\t\t\t\t\t});\n\t\t\t\t\tSwal('Good job!','You clicked the button!','success')\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tSwal('Oops...', 'Something went wrong!', 'error')\n\t\t}\n\t\t\n\n\t}\n\n\thandleAddDoctor = (user_id) => {\n\t\tvar { order } = this.state;\n\t\tif( user_id !== null && user_id !== \"0\") {\n            var data = {user_id: user_id};\n            callApi('PUT', config.ORDER_URL + 'user/' + order.id, data).then(res => {\n                if ( res.data.status ) {\n                    this.setState({\n                        doctor: res.data.data.user\n                    });\n                    Swal('Good job!','You clicked the button!','success')\n                }\n            });\n        } else {\n            Swal('Oops...', 'Something went wrong!', 'error')\n        }\n\t}\n\n\trender() {\n\t\tvar { order, customer, order_detail, category_title, date_remain, doctor, categories } = this.state;\n\n\t\treturn (\n\n\t\t\t<CSSTransitionGroup transitionName=\"worksTransition\" transitionAppear={true} transitionAppearTimeout={500} transitionEnter={false} transitionLeave={false}>\n\n\t\t\t\t<React.Fragment>\n\t\t\t\t\t\n\t\t\t\t\t<OrderInfo order={order} category_title={category_title}/>\n\t\t\t\t\t\n\t\t\t\t\t<CustomerInfo customer={customer} />\n\t\t\t\t\t\n\t\t\t\t\t<AddDoctor doctor={doctor} handleAddDoctor={this.handleAddDoctor}/>\n\n\t\t\t\t\t<div className=\"clearfix\"></div>\n\n\t\t\t\t\t<AddServices \n\t\t\t\t\t\tcategories={categories} \n\t\t\t\t\t\torder_detail={order_detail} \n\t\t\t\t\t\tcustomer={customer} \n\t\t\t\t\t\thandleDeleteService={this.handleDeleteService} \n\t\t\t\t\t\thandleAddService={this.handleAddService}\n\t\t\t\t\t/>\n\n\t\t\t\t\t{/* add date remain */}\n\t\t\t\t\t<div className=\"clearfix\"></div>\n\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t</React.Fragment>\n\t\t\t\t</CSSTransitionGroup>\n\t\t);\n\t} // end render\n\n\tremainder = (date_remain) => {\n\t\tvar date = null;\n\t\tif(typeof date_remain !== 'undefined' && date_remain.length > 1){\n\t\t\tvar from = date_remain.slice(0,10).split(\"-\");\n\t\t\tdate = from[2]+'/'+from[1]+'/'+from[0];\n\t\t}\n\t\treturn date;\n\t}\n\n\t\n\t\n\t\n}\n\nexport default OrderActionPage;\n"]},"metadata":{},"sourceType":"module"}